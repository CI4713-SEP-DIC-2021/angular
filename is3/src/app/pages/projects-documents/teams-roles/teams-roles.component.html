<div class="fondo">
    <app-sidebar></app-sidebar>
  <!-- Teams-Roles Card -->
  <mat-card style="width: 70%; margin: 0 auto; margin-top: 30px; height: 35rem; overflow-y: scroll;">
      <mat-card-title>Equipos y roles del proyecto</mat-card-title>
      <mat-divider style="margin-top: 10px"></mat-divider>
    
      <div style="float: right">
    
        <!-- Add member -->
        <button mat-button class="add-button" style="margin-top: 15px" (click)="addMember()"> Agregar miembro
          <mat-icon style="margin-left: 20px">add</mat-icon>
        </button>
      </div>

      <div class="example-table-container" style="margin-bottom: 20px">
        <!-- Table of members -->
        <table mat-table *ngIf="membersList" [dataSource]="membersList" class="mat-elevation-z8" style="width: 100%;">
        
          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef> Nombre </th>
            <td mat-cell *matCellDef="let element"> {{element.name}} </td>
          </ng-container>
        
          <ng-container matColumnDef="mail">
            <th mat-header-cell *matHeaderCellDef> Correo </th>
            <td mat-cell *matCellDef="let element"> {{element.email}} </td>
          </ng-container>

          <ng-container matColumnDef="telefono">
            <th mat-header-cell *matHeaderCellDef> Telefono </th>
            <td mat-cell *matCellDef="let element" > {{ element.phone_number}} </td>
          </ng-container>

          <ng-container matColumnDef="rol">
            <th mat-header-cell *matHeaderCellDef> Rol </th>
            <td mat-cell *matCellDef="let element"> {{ element.role}} </td>
          </ng-container>
        
          <!-- Actions Column --> 
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef style="width: 350px">  </th>
            <td mat-cell *matCellDef="let element; let i = index">
                <span style="margin-right: 55px"></span>

                <!-- Edit-->
                <button mat-icon-button (click)="editMember(element.name, element.email, element.phone_number, element.role, element.username, i)" class="action-buttons">
                    <mat-icon>edit</mat-icon>
                </button>
                <!-- Delete -->
                <button mat-icon-button (click)="deleteMember(i)" class="delete-button">
                    <mat-icon>delete</mat-icon>
                </button>

            </td>
          </ng-container>
        
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>



        <div style="float: right">
          <!-- Add new team -->
          <button mat-button class="add-button" style="margin-top: 15px" (click)="addTeam()"> Agregar equipo
            <mat-icon style="margin-left: 20px">add</mat-icon>
          </button>
        </div>


      </div> 


      <!-- Teams and their members -->
      <div *ngFor="let team of teamsList; let teamIndex=index" style="margin-top: 0px">
        <mat-divider></mat-divider>
        <mat-card-title class="teams-title">{{ team.name }}</mat-card-title>
        <button mat-icon-button style="float: right" (click)="addTeamMember(teamIndex)">
          <mat-icon>add</mat-icon>
        </button>


        <div class="example-table-container" style="margin-bottom: 20px">
          <!-- Table of members -->
          <table mat-table *ngIf="team.members" [dataSource]="team.members" class="mat-elevation-z8" style="width: 100%;">
          
            <ng-container matColumnDef="nombre">
              <th mat-header-cell *matHeaderCellDef> Nombre </th>
              <td mat-cell *matCellDef="let element"> {{element.name}} </td>
            </ng-container>
          
            <ng-container matColumnDef="mail">
              <th mat-header-cell *matHeaderCellDef> Correo </th>
              <td mat-cell *matCellDef="let element"> {{element.email}} </td>
            </ng-container>
  
            <ng-container matColumnDef="telefono">
              <th mat-header-cell *matHeaderCellDef> Telefono </th>
              <td mat-cell *matCellDef="let element" > {{ element.phone_number}} </td>
            </ng-container>
  
            <ng-container matColumnDef="rol">
              <th mat-header-cell *matHeaderCellDef> Rol </th>
              <td mat-cell *matCellDef="let element"> {{ element.role}} </td>
            </ng-container>
          
            <!-- Actions Column --> 
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef style="width: 350px">  </th>
              <td mat-cell *matCellDef="let element; let i = index">
                  <span style="margin-right: 55px"></span>
  
                  <!-- Edit-->
                  <button mat-icon-button (click)="editTeamMember(team.name, element.name, element.email, element.phone_number, element.role, element.username, i, teamIndex)" class="action-buttons">
                      <mat-icon>edit</mat-icon>
                  </button>
                  <!-- Delete -->
                  <button mat-icon-button (click)="deleteTeamMember(i, teamIndex)" class="delete-button">
                      <mat-icon>delete</mat-icon>
                  </button>
  
              </td>
            </ng-container>
          
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div> 

      </div>

    </mat-card>
    
  <app-footer></app-footer>
</div>
